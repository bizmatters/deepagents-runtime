================================================================================
NATS Events Integration Tests - Local Execution
================================================================================
  Platform Branch: main
  Workspace:       /Users/arun_subramanian/Projects/biz-matters
  Platform Dir:    /Users/arun_subramanian/Projects/biz-matters/zerotouch-platform
  Artifacts Dir:   /Users/arun_subramanian/Projects/biz-matters/deepagents-runtime/artifacts
================================================================================
[0;34m[INFO][0m Loading environment variables from .env...
[0;32m[SUCCESS][0m Environment variables loaded from .env
[0;34m[INFO][0m Validating prerequisites...
[0;32m[SUCCESS][0m Prerequisites validated
[0;34m[INFO][0m Creating fresh platform directory for clean Git state...
[0;34m[INFO][0m Cloning platform repository for clean Git state...
Cloning into '/Users/arun_subramanian/Projects/biz-matters/zerotouch-platform-fresh'...
done.
[0;32m[SUCCESS][0m Fresh platform directory created at: /Users/arun_subramanian/Projects/biz-matters/zerotouch-platform-fresh
[0;34m[INFO][0m Exporting AWS credentials...
[0;32m[SUCCESS][0m AWS credentials exported
[0;34m[INFO][0m Setting up Python environment...
[0;34m[INFO][0m Creating Python virtual environment...
[0;32m[SUCCESS][0m Virtual environment activated
[0;34m[INFO][0m Installing Python dependencies...
Requirement already satisfied: pip in ./.venv/lib/python3.12/site-packages (25.3)
Obtaining file:///Users/arun_subramanian/Projects/biz-matters/deepagents-runtime
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: fastapi>=0.115.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.124.4)
Requirement already satisfied: uvicorn>=0.32.0 in ./.venv/lib/python3.12/site-packages (from uvicorn[standard]>=0.32.0->deepagents_runtime==0.1.0) (0.38.0)
Requirement already satisfied: nats-py>=2.9.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (2.12.0)
Requirement already satisfied: deepagents>=0.2.7 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.3.0)
Requirement already satisfied: langgraph>=1.0.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.0.4)
Requirement already satisfied: langgraph-checkpoint-postgres>=3.0.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (3.0.2)
Requirement already satisfied: langchain>=1.0.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.1.3)
Requirement already satisfied: langchain-openai>=0.3.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.1.2)
Requirement already satisfied: langchain-anthropic>=1.0.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.2.0)
Requirement already satisfied: langsmith>=0.2.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.4.59)
Requirement already satisfied: psycopg>=3.2.0 in ./.venv/lib/python3.12/site-packages (from psycopg[binary,pool]>=3.2.0->deepagents_runtime==0.1.0) (3.3.2)
Requirement already satisfied: redis>=5.2.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (7.1.0)
Requirement already satisfied: cloudevents>=1.11.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.12.0)
Requirement already satisfied: pydantic>=2.10.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (2.12.5)
Requirement already satisfied: pydantic-settings>=2.1.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (2.12.0)
Requirement already satisfied: structlog>=24.4.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (25.5.0)
Requirement already satisfied: opentelemetry-api>=1.28.2 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: opentelemetry-sdk>=1.28.2 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: opentelemetry-instrumentation-fastapi>=0.49b2 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.60b1)
Requirement already satisfied: opentelemetry-exporter-otlp>=1.28.2 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: httpx>=0.27.2 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.28.1)
Requirement already satisfied: prometheus-client>=0.19.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.23.1)
Requirement already satisfied: python-dotenv>=1.0.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.2.1)
Requirement already satisfied: jsonschema>=4.23.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (4.25.1)
Requirement already satisfied: pytest>=8.3.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (9.0.2)
Requirement already satisfied: pytest-asyncio>=0.24.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.3.0)
Requirement already satisfied: pytest-mock>=3.14.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (3.15.1)
Requirement already satisfied: pytest-cov>=4.1.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (7.0.0)
Requirement already satisfied: pytest-timeout>=2.3.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (2.4.0)
Requirement already satisfied: black>=24.1.1 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (25.12.0)
Requirement already satisfied: ruff>=0.1.13 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (0.14.9)
Requirement already satisfied: mypy>=1.8.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (1.19.0)
Requirement already satisfied: types-redis>=4.6.0 in ./.venv/lib/python3.12/site-packages (from deepagents_runtime==0.1.0) (4.6.0.20241004)
Requirement already satisfied: langgraph-cli>=0.4.4 in ./.venv/lib/python3.12/site-packages (from langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (0.4.9)
Requirement already satisfied: click>=8.0.0 in ./.venv/lib/python3.12/site-packages (from black>=24.1.1->deepagents_runtime==0.1.0) (8.3.1)
Requirement already satisfied: mypy-extensions>=0.4.3 in ./.venv/lib/python3.12/site-packages (from black>=24.1.1->deepagents_runtime==0.1.0) (1.1.0)
Requirement already satisfied: packaging>=22.0 in ./.venv/lib/python3.12/site-packages (from black>=24.1.1->deepagents_runtime==0.1.0) (25.0)
Requirement already satisfied: pathspec>=0.9.0 in ./.venv/lib/python3.12/site-packages (from black>=24.1.1->deepagents_runtime==0.1.0) (0.12.1)
Requirement already satisfied: platformdirs>=2 in ./.venv/lib/python3.12/site-packages (from black>=24.1.1->deepagents_runtime==0.1.0) (4.5.1)
Requirement already satisfied: pytokens>=0.3.0 in ./.venv/lib/python3.12/site-packages (from black>=24.1.1->deepagents_runtime==0.1.0) (0.3.0)
Requirement already satisfied: deprecation<3.0,>=2.0 in ./.venv/lib/python3.12/site-packages (from cloudevents>=1.11.0->deepagents_runtime==0.1.0) (2.1.0)
Requirement already satisfied: langchain-core<2.0.0,>=1.1.0 in ./.venv/lib/python3.12/site-packages (from deepagents>=0.2.7->deepagents_runtime==0.1.0) (1.1.3)
Requirement already satisfied: wcmatch in ./.venv/lib/python3.12/site-packages (from deepagents>=0.2.7->deepagents_runtime==0.1.0) (10.1)
Requirement already satisfied: anthropic<1.0.0,>=0.73.0 in ./.venv/lib/python3.12/site-packages (from langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (0.75.0)
Requirement already satisfied: anyio<5,>=3.5.0 in ./.venv/lib/python3.12/site-packages (from anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (4.12.0)
Requirement already satisfied: distro<2,>=1.7.0 in ./.venv/lib/python3.12/site-packages (from anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (1.9.0)
Requirement already satisfied: docstring-parser<1,>=0.15 in ./.venv/lib/python3.12/site-packages (from anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (0.17.0)
Requirement already satisfied: jiter<1,>=0.4.0 in ./.venv/lib/python3.12/site-packages (from anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (0.12.0)
Requirement already satisfied: sniffio in ./.venv/lib/python3.12/site-packages (from anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (1.3.1)
Requirement already satisfied: typing-extensions<5,>=4.10 in ./.venv/lib/python3.12/site-packages (from anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (4.15.0)
Requirement already satisfied: idna>=2.8 in ./.venv/lib/python3.12/site-packages (from anyio<5,>=3.5.0->anthropic<1.0.0,>=0.73.0->langchain-anthropic>=1.0.0->deepagents_runtime==0.1.0) (3.11)
Requirement already satisfied: certifi in ./.venv/lib/python3.12/site-packages (from httpx>=0.27.2->deepagents_runtime==0.1.0) (2025.11.12)
Requirement already satisfied: httpcore==1.* in ./.venv/lib/python3.12/site-packages (from httpx>=0.27.2->deepagents_runtime==0.1.0) (1.0.9)
Requirement already satisfied: h11>=0.16 in ./.venv/lib/python3.12/site-packages (from httpcore==1.*->httpx>=0.27.2->deepagents_runtime==0.1.0) (0.16.0)
Requirement already satisfied: jsonpatch<2.0.0,>=1.33.0 in ./.venv/lib/python3.12/site-packages (from langchain-core<2.0.0,>=1.1.0->deepagents>=0.2.7->deepagents_runtime==0.1.0) (1.33)
Requirement already satisfied: pyyaml<7.0.0,>=5.3.0 in ./.venv/lib/python3.12/site-packages (from langchain-core<2.0.0,>=1.1.0->deepagents>=0.2.7->deepagents_runtime==0.1.0) (6.0.3)
Requirement already satisfied: tenacity!=8.4.0,<10.0.0,>=8.1.0 in ./.venv/lib/python3.12/site-packages (from langchain-core<2.0.0,>=1.1.0->deepagents>=0.2.7->deepagents_runtime==0.1.0) (9.1.2)
Requirement already satisfied: uuid-utils<1.0,>=0.12.0 in ./.venv/lib/python3.12/site-packages (from langchain-core<2.0.0,>=1.1.0->deepagents>=0.2.7->deepagents_runtime==0.1.0) (0.12.0)
Requirement already satisfied: jsonpointer>=1.9 in ./.venv/lib/python3.12/site-packages (from jsonpatch<2.0.0,>=1.33.0->langchain-core<2.0.0,>=1.1.0->deepagents>=0.2.7->deepagents_runtime==0.1.0) (3.0.0)
Requirement already satisfied: langgraph-checkpoint<4.0.0,>=2.1.0 in ./.venv/lib/python3.12/site-packages (from langgraph>=1.0.0->deepagents_runtime==0.1.0) (3.0.1)
Requirement already satisfied: langgraph-prebuilt<1.1.0,>=1.0.2 in ./.venv/lib/python3.12/site-packages (from langgraph>=1.0.0->deepagents_runtime==0.1.0) (1.0.5)
Requirement already satisfied: langgraph-sdk<0.3.0,>=0.2.2 in ./.venv/lib/python3.12/site-packages (from langgraph>=1.0.0->deepagents_runtime==0.1.0) (0.2.15)
Requirement already satisfied: xxhash>=3.5.0 in ./.venv/lib/python3.12/site-packages (from langgraph>=1.0.0->deepagents_runtime==0.1.0) (3.6.0)
Requirement already satisfied: ormsgpack>=1.12.0 in ./.venv/lib/python3.12/site-packages (from langgraph-checkpoint<4.0.0,>=2.1.0->langgraph>=1.0.0->deepagents_runtime==0.1.0) (1.12.0)
Requirement already satisfied: orjson>=3.10.1 in ./.venv/lib/python3.12/site-packages (from langgraph-sdk<0.3.0,>=0.2.2->langgraph>=1.0.0->deepagents_runtime==0.1.0) (3.11.5)
Requirement already satisfied: requests-toolbelt>=1.0.0 in ./.venv/lib/python3.12/site-packages (from langsmith>=0.2.0->deepagents_runtime==0.1.0) (1.0.0)
Requirement already satisfied: requests>=2.0.0 in ./.venv/lib/python3.12/site-packages (from langsmith>=0.2.0->deepagents_runtime==0.1.0) (2.32.5)
Requirement already satisfied: zstandard>=0.23.0 in ./.venv/lib/python3.12/site-packages (from langsmith>=0.2.0->deepagents_runtime==0.1.0) (0.25.0)
Requirement already satisfied: annotated-types>=0.6.0 in ./.venv/lib/python3.12/site-packages (from pydantic>=2.10.0->deepagents_runtime==0.1.0) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.5 in ./.venv/lib/python3.12/site-packages (from pydantic>=2.10.0->deepagents_runtime==0.1.0) (2.41.5)
Requirement already satisfied: typing-inspection>=0.4.2 in ./.venv/lib/python3.12/site-packages (from pydantic>=2.10.0->deepagents_runtime==0.1.0) (0.4.2)
Requirement already satisfied: starlette<0.51.0,>=0.40.0 in ./.venv/lib/python3.12/site-packages (from fastapi>=0.115.0->deepagents_runtime==0.1.0) (0.50.0)
Requirement already satisfied: annotated-doc>=0.0.2 in ./.venv/lib/python3.12/site-packages (from fastapi>=0.115.0->deepagents_runtime==0.1.0) (0.0.4)
Requirement already satisfied: attrs>=22.2.0 in ./.venv/lib/python3.12/site-packages (from jsonschema>=4.23.0->deepagents_runtime==0.1.0) (25.4.0)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in ./.venv/lib/python3.12/site-packages (from jsonschema>=4.23.0->deepagents_runtime==0.1.0) (2025.9.1)
Requirement already satisfied: referencing>=0.28.4 in ./.venv/lib/python3.12/site-packages (from jsonschema>=4.23.0->deepagents_runtime==0.1.0) (0.37.0)
Requirement already satisfied: rpds-py>=0.7.1 in ./.venv/lib/python3.12/site-packages (from jsonschema>=4.23.0->deepagents_runtime==0.1.0) (0.30.0)
Requirement already satisfied: openai<3.0.0,>=1.109.1 in ./.venv/lib/python3.12/site-packages (from langchain-openai>=0.3.0->deepagents_runtime==0.1.0) (2.11.0)
Requirement already satisfied: tiktoken<1.0.0,>=0.7.0 in ./.venv/lib/python3.12/site-packages (from langchain-openai>=0.3.0->deepagents_runtime==0.1.0) (0.12.0)
Requirement already satisfied: tqdm>4 in ./.venv/lib/python3.12/site-packages (from openai<3.0.0,>=1.109.1->langchain-openai>=0.3.0->deepagents_runtime==0.1.0) (4.67.1)
Requirement already satisfied: regex>=2022.1.18 in ./.venv/lib/python3.12/site-packages (from tiktoken<1.0.0,>=0.7.0->langchain-openai>=0.3.0->deepagents_runtime==0.1.0) (2025.11.3)
Requirement already satisfied: psycopg-pool>=3.2.0 in ./.venv/lib/python3.12/site-packages (from langgraph-checkpoint-postgres>=3.0.0->deepagents_runtime==0.1.0) (3.3.0)
Requirement already satisfied: langgraph-api<0.6.0,>=0.5.35 in ./.venv/lib/python3.12/site-packages (from langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (0.5.41)
Requirement already satisfied: langgraph-runtime-inmem>=0.7 in ./.venv/lib/python3.12/site-packages (from langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (0.20.1)
Requirement already satisfied: cloudpickle>=3.0.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (3.1.2)
Requirement already satisfied: cryptography<45.0,>=42.0.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (44.0.3)
Requirement already satisfied: grpcio-tools==1.75.1 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (1.75.1)
Requirement already satisfied: grpcio<2.0.0,>=1.75.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (1.76.0)
Requirement already satisfied: jsonschema-rs<0.30,>=0.20.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (0.29.1)
Requirement already satisfied: opentelemetry-exporter-otlp-proto-http>=1.37.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: protobuf<7.0.0,>=6.32.1 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (6.33.2)
Requirement already satisfied: pyjwt>=2.9.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (2.10.1)
Requirement already satisfied: sse-starlette<2.2.0,>=2.1.0 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (2.1.3)
Requirement already satisfied: truststore>=0.1 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (0.10.4)
Requirement already satisfied: watchfiles>=0.13 in ./.venv/lib/python3.12/site-packages (from langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (1.1.1)
Requirement already satisfied: setuptools in ./.venv/lib/python3.12/site-packages (from grpcio-tools==1.75.1->langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (80.9.0)
Requirement already satisfied: cffi>=1.12 in ./.venv/lib/python3.12/site-packages (from cryptography<45.0,>=42.0.0->langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (2.0.0)
Requirement already satisfied: blockbuster<2.0.0,>=1.5.24 in ./.venv/lib/python3.12/site-packages (from langgraph-runtime-inmem>=0.7->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (1.5.26)
Requirement already satisfied: forbiddenfruit>=0.1.4 in ./.venv/lib/python3.12/site-packages (from blockbuster<2.0.0,>=1.5.24->langgraph-runtime-inmem>=0.7->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (0.1.4)
Requirement already satisfied: pycparser in ./.venv/lib/python3.12/site-packages (from cffi>=1.12->cryptography<45.0,>=42.0.0->langgraph-api<0.6.0,>=0.5.35->langgraph-cli[inmem]>=0.4.4; extra == "dev"->deepagents_runtime==0.1.0) (2.23)
Requirement already satisfied: librt>=0.6.2 in ./.venv/lib/python3.12/site-packages (from mypy>=1.8.0->deepagents_runtime==0.1.0) (0.7.3)
Requirement already satisfied: importlib-metadata<8.8.0,>=6.0 in ./.venv/lib/python3.12/site-packages (from opentelemetry-api>=1.28.2->deepagents_runtime==0.1.0) (8.7.0)
Requirement already satisfied: zipp>=3.20 in ./.venv/lib/python3.12/site-packages (from importlib-metadata<8.8.0,>=6.0->opentelemetry-api>=1.28.2->deepagents_runtime==0.1.0) (3.23.0)
Requirement already satisfied: opentelemetry-exporter-otlp-proto-grpc==1.39.1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-exporter-otlp>=1.28.2->deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: googleapis-common-protos~=1.57 in ./.venv/lib/python3.12/site-packages (from opentelemetry-exporter-otlp-proto-grpc==1.39.1->opentelemetry-exporter-otlp>=1.28.2->deepagents_runtime==0.1.0) (1.72.0)
Requirement already satisfied: opentelemetry-exporter-otlp-proto-common==1.39.1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-exporter-otlp-proto-grpc==1.39.1->opentelemetry-exporter-otlp>=1.28.2->deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: opentelemetry-proto==1.39.1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-exporter-otlp-proto-grpc==1.39.1->opentelemetry-exporter-otlp>=1.28.2->deepagents_runtime==0.1.0) (1.39.1)
Requirement already satisfied: opentelemetry-semantic-conventions==0.60b1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-sdk>=1.28.2->deepagents_runtime==0.1.0) (0.60b1)
Requirement already satisfied: charset_normalizer<4,>=2 in ./.venv/lib/python3.12/site-packages (from requests>=2.0.0->langsmith>=0.2.0->deepagents_runtime==0.1.0) (3.4.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./.venv/lib/python3.12/site-packages (from requests>=2.0.0->langsmith>=0.2.0->deepagents_runtime==0.1.0) (2.6.2)
Requirement already satisfied: opentelemetry-instrumentation-asgi==0.60b1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-instrumentation-fastapi>=0.49b2->deepagents_runtime==0.1.0) (0.60b1)
Requirement already satisfied: opentelemetry-instrumentation==0.60b1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-instrumentation-fastapi>=0.49b2->deepagents_runtime==0.1.0) (0.60b1)
Requirement already satisfied: opentelemetry-util-http==0.60b1 in ./.venv/lib/python3.12/site-packages (from opentelemetry-instrumentation-fastapi>=0.49b2->deepagents_runtime==0.1.0) (0.60b1)
Requirement already satisfied: wrapt<2.0.0,>=1.0.0 in ./.venv/lib/python3.12/site-packages (from opentelemetry-instrumentation==0.60b1->opentelemetry-instrumentation-fastapi>=0.49b2->deepagents_runtime==0.1.0) (1.17.3)
Requirement already satisfied: asgiref~=3.0 in ./.venv/lib/python3.12/site-packages (from opentelemetry-instrumentation-asgi==0.60b1->opentelemetry-instrumentation-fastapi>=0.49b2->deepagents_runtime==0.1.0) (3.11.0)
Requirement already satisfied: psycopg-binary==3.3.2 in ./.venv/lib/python3.12/site-packages (from psycopg[binary,pool]>=3.2.0->deepagents_runtime==0.1.0) (3.3.2)
Requirement already satisfied: iniconfig>=1.0.1 in ./.venv/lib/python3.12/site-packages (from pytest>=8.3.0->deepagents_runtime==0.1.0) (2.3.0)
Requirement already satisfied: pluggy<2,>=1.5 in ./.venv/lib/python3.12/site-packages (from pytest>=8.3.0->deepagents_runtime==0.1.0) (1.6.0)
Requirement already satisfied: pygments>=2.7.2 in ./.venv/lib/python3.12/site-packages (from pytest>=8.3.0->deepagents_runtime==0.1.0) (2.19.2)
Requirement already satisfied: coverage>=7.10.6 in ./.venv/lib/python3.12/site-packages (from coverage[toml]>=7.10.6->pytest-cov>=4.1.0->deepagents_runtime==0.1.0) (7.13.0)
Requirement already satisfied: types-pyOpenSSL in ./.venv/lib/python3.12/site-packages (from types-redis>=4.6.0->deepagents_runtime==0.1.0) (24.1.0.20240722)
Requirement already satisfied: httptools>=0.6.3 in ./.venv/lib/python3.12/site-packages (from uvicorn[standard]>=0.32.0->deepagents_runtime==0.1.0) (0.7.1)
Requirement already satisfied: uvloop>=0.15.1 in ./.venv/lib/python3.12/site-packages (from uvicorn[standard]>=0.32.0->deepagents_runtime==0.1.0) (0.22.1)
Requirement already satisfied: websockets>=10.4 in ./.venv/lib/python3.12/site-packages (from uvicorn[standard]>=0.32.0->deepagents_runtime==0.1.0) (15.0.1)
Requirement already satisfied: types-cffi in ./.venv/lib/python3.12/site-packages (from types-pyOpenSSL->types-redis>=4.6.0->deepagents_runtime==0.1.0) (1.17.0.20250915)
Requirement already satisfied: types-setuptools in ./.venv/lib/python3.12/site-packages (from types-cffi->types-pyOpenSSL->types-redis>=4.6.0->deepagents_runtime==0.1.0) (80.9.0.20250822)
Requirement already satisfied: bracex>=2.1.1 in ./.venv/lib/python3.12/site-packages (from wcmatch->deepagents>=0.2.7->deepagents_runtime==0.1.0) (2.6)
Building wheels for collected packages: deepagents_runtime
  Building editable for deepagents_runtime (pyproject.toml): started
  Building editable for deepagents_runtime (pyproject.toml): finished with status 'done'
  Created wheel for deepagents_runtime: filename=deepagents_runtime-0.1.0-0.editable-py3-none-any.whl size=5224 sha256=2c669e4e6c0c3c6b31355aa55de6c2b3081176567abe0a398103da989203f55a
  Stored in directory: /private/var/folders/k0/2mrr_vvn7zn8d3hg6ymscktm0000gn/T/pip-ephem-wheel-cache-m4wly_1o/wheels/52/83/97/d8bb6a2b476c068bf511074823f65ec580aa38b9cd117f1041
Successfully built deepagents_runtime
Installing collected packages: deepagents_runtime
  Attempting uninstall: deepagents_runtime
    Found existing installation: deepagents_runtime 0.1.0
    Uninstalling deepagents_runtime-0.1.0:
      Successfully uninstalled deepagents_runtime-0.1.0
Successfully installed deepagents_runtime-0.1.0
[0;32m[SUCCESS][0m Python dependencies installed
[0;34m[INFO][0m Bootstrapping platform preview environment...
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   BizMatters Infrastructure - Master Bootstrap Script      â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;32mMode:[0m preview

[0;34mRunning in PREVIEW mode (GitHub Actions/Kind)[0m

[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Setup Preview Cluster                                     â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mPreview mode configured[0m

[0;34mApplying preview patches...[0m
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Applying Preview/Kind Patches                             â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mRunning: 03-patch-tolerations.sh[0m
[1;33mNOTE: This script is now deprecated.[0m
[0;34mControl plane toleration removal is now handled by Kustomize overlays in bootstrap/argocd/overlays/preview[0m
[0;32mâœ“ No action needed - overlays will handle toleration patching automatically[0m

[0;34mRunning: 04-exclude-local-path.sh[0m
[0;34mExcluding local-path-provisioner from preview mode...[0m
  [0;32mâœ“[0m Disabled: 00-local-path-provisioner.yaml
  [0;32mâœ“[0m No 00-* files found in base directory
  [0;34mâ„¹[0m Kind clusters use built-in local-path storage
  [0;34mâ„¹[0m Preview overlay excludes 00-* bootstrap files
[0;32mâœ“ Local-path-provisioner excluded from preview mode[0m

[0;34mRunning: 05-verify-storage-provisioner.sh[0m
[0;34mVerifying local-path-provisioner for Kind cluster...[0m
[0;34mContext: kind-zerotouch-preview[0m
[0;34mChecking for Kind's built-in provisioner...[0m
  [0;32mâœ“[0m Kind v1.34+ detected with built-in provisioner (storage class: standard)
[0;34mChecking storage class configuration...[0m
[0;34mCurrent storage classes:[0m
NAME         PROVISIONER             DEFAULT
local-path   rancher.io/local-path   false
standard     rancher.io/local-path   true
  [0;32mâœ“[0m local-path storage class exists (provisioner: rancher.io/local-path, default: false)
[0;32mâœ“ Storage provisioner verification complete[0m
[0;34mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m

[0;34mRunning: 06-optimize-preview-resources.sh[0m
[0;34mOptimizing resources for preview mode...[0m
  [0;32mâœ“[0m Disabled NATS persistence (using memory-only mode)
  [0;32mâœ“[0m Reduced NATS CPU (50m request, 250m limit)
[0;34mVerifying overlay optimizations...[0m
  [0;32mâœ“[0m Overlay optimizations verified (NATS, Kagent, KEDA)
[0;32mâœ“ Preview resource optimizations applied[0m
[0;34m  Estimated savings: ~400m CPU, ~500Mi memory[0m

[0;34mRunning: 07-disable-cilium-for-kind.sh[0m
[1;33mNOTE: This script is now deprecated.[0m
[0;34mCilium exclusion is now handled by Kustomize overlays:[0m
[0;34m  - bootstrap/argocd/overlays/preview/kustomization.yaml excludes cilium.yaml[0m
[0;34m  - bootstrap/argocd/overlays/production includes Cilium in overlays/production/cilium/[0m
[0;32mâœ“ No action needed - overlay structure handles Cilium exclusion[0m
[0;34m  Kind clusters use kindnet CNI instead[0m

[0;32mâœ“ All preview patches applied successfully[0m

[0;34mUpdating Kind config to mount local repo...[0m
[0;32mâœ“ Kind config updated with local repo mount at /repo[0m

[0;32mâœ“ AWS credentials configured[0m

[1;33mChecking required tools...[0m
[0;32mâœ“ kubectl available[0m
[0;32mâœ“ helm available[0m
[0;32mâœ“ kind available[0m

[1;33mKind cluster 'zerotouch-preview' already exists[0m
Switched to context "kind-zerotouch-preview".
[0;34mLabeling nodes for database workloads...[0m
node/zerotouch-preview-control-plane not labeled
[0;32mâœ“ Nodes labeled[0m


[0;32mâœ“ Preview cluster setup complete[0m
  Cluster: [0;34mkind-zerotouch-preview[0m
  Context: [0;34mkind-zerotouch-preview[0m

[0;34m[1-5/14] Skipping Talos installation (preview mode uses Kind)[0m
[1;33m[6/14] Injecting ESO secrets...[0m
Using AWS credentials from environment variables
  â„¹ No session token (using long-term credentials)
Ensuring external-secrets namespace exists...
namespace/external-secrets unchanged
Creating aws-access-token secret in external-secrets namespace...
secret/aws-access-token unchanged
âœ“ AWS credentials injected (long-term credentials)
ESO can now authenticate to AWS Systems Manager Parameter Store
[1;33m[7/14] Injecting SSM parameters...[0m
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   AWS SSM Parameter Store - Secrets Injection               â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[1;33mâš ï¸  .env.ssm not found, generating from environment variables...[0m
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Generate .env.ssm from Environment Variables              â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;32mâœ“ Template: .env.ssm.example[0m
[0;32mâœ“ Output: .env.ssm[0m

[0;32mâœ“ Mapped OPENAI_API_KEY -> /zerotouch/prod/openai_api_key[0m
[0;32mâœ“ Mapped ANTHROPIC_API_KEY -> /zerotouch/prod/anthropic_api_key[0m
[0;32mâœ“ Mapped BOT_GITHUB_USERNAME -> /zerotouch/prod/ghcr/username[0m
[0;32mâœ“ Mapped BOT_GITHUB_USERNAME -> /zerotouch/prod/github/username[0m
[0;32mâœ“ Mapped BOT_GITHUB_TOKEN -> /zerotouch/prod/ghcr/password[0m
[0;32mâœ“ Mapped BOT_GITHUB_TOKEN -> /zerotouch/prod/github/token[0m
[1;33mâš ï¸  Environment variable TENANTS_REPO_URL not set for /zerotouch/prod/argocd/repos/zerotouch-tenants/url[0m
[0;32mâœ“ Mapped BOT_GITHUB_USERNAME -> /zerotouch/prod/argocd/repos/zerotouch-tenants/username[0m
[0;32mâœ“ Mapped BOT_GITHUB_TOKEN -> /zerotouch/prod/argocd/repos/zerotouch-tenants/password[0m

[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Summary                                                    â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;32mâœ“ Parameters mapped: 8[0m
[1;33mâš ï¸  Parameters missing: 1[0m

[0;32mâœ“ Generated .env.ssm from environment variables[0m
[0;32mâœ“ AWS CLI configured[0m
[0;32mâœ“ Region: ap-south-1[0m

[0;34mProcessing .env.ssm...[0m

[0;34mCreating parameter:[0m /zerotouch/prod/openai_api_key
[0;32mâœ“ Created: /zerotouch/prod/openai_api_key[0m
[0;34mCreating parameter:[0m /zerotouch/prod/anthropic_api_key
[0;32mâœ“ Created: /zerotouch/prod/anthropic_api_key[0m
[0;34mCreating parameter:[0m /zerotouch/prod/ghcr/username
[0;32mâœ“ Created: /zerotouch/prod/ghcr/username[0m
[0;34mCreating parameter:[0m /zerotouch/prod/github/username
[0;32mâœ“ Created: /zerotouch/prod/github/username[0m
[0;34mCreating parameter:[0m /zerotouch/prod/ghcr/password
[0;32mâœ“ Created: /zerotouch/prod/ghcr/password[0m
[0;34mCreating parameter:[0m /zerotouch/prod/github/token
[0;32mâœ“ Created: /zerotouch/prod/github/token[0m
[0;34mCreating parameter:[0m /zerotouch/prod/argocd/repos/zerotouch-tenants/username
[0;32mâœ“ Created: /zerotouch/prod/argocd/repos/zerotouch-tenants/username[0m
[0;34mCreating parameter:[0m /zerotouch/prod/argocd/repos/zerotouch-tenants/password
[0;32mâœ“ Created: /zerotouch/prod/argocd/repos/zerotouch-tenants/password[0m

[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Summary                                                    â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;32mâœ“ Parameters created: 8[0m

[0;32mâœ“ Secrets successfully injected into AWS SSM Parameter Store[0m

[1;33mNext steps:[0m
  1. Verify parameters: [0;32maws ssm get-parameters-by-path --path /zerotouch/prod --recursive --region ap-south-1[0m
  2. ESO will automatically sync these secrets to Kubernetes
  3. Check ExternalSecret status: [0;32mkubectl get externalsecret -A[0m

[1;33m[8a/14] Applying patches before ArgoCD installation...[0m
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Applying Preview/Kind Patches                             â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mRunning: 03-patch-tolerations.sh[0m
[1;33mNOTE: This script is now deprecated.[0m
[0;34mControl plane toleration removal is now handled by Kustomize overlays in bootstrap/argocd/overlays/preview[0m
[0;32mâœ“ No action needed - overlays will handle toleration patching automatically[0m

[0;34mRunning: 04-exclude-local-path.sh[0m
[0;34mExcluding local-path-provisioner from preview mode...[0m
  [0;32mâœ“[0m Already disabled: 00-local-path-provisioner.yaml
  [0;32mâœ“[0m No 00-* files found in base directory
  [0;34mâ„¹[0m Kind clusters use built-in local-path storage
  [0;34mâ„¹[0m Preview overlay excludes 00-* bootstrap files
[0;32mâœ“ Local-path-provisioner excluded from preview mode[0m

[0;34mRunning: 05-verify-storage-provisioner.sh[0m
[0;34mVerifying local-path-provisioner for Kind cluster...[0m
[0;34mContext: kind-zerotouch-preview[0m
[0;34mChecking for Kind's built-in provisioner...[0m
  [0;32mâœ“[0m Kind v1.34+ detected with built-in provisioner (storage class: standard)
[0;34mChecking storage class configuration...[0m
[0;34mCurrent storage classes:[0m
NAME         PROVISIONER             DEFAULT
local-path   rancher.io/local-path   false
standard     rancher.io/local-path   true
  [0;32mâœ“[0m local-path storage class exists (provisioner: rancher.io/local-path, default: false)
[0;32mâœ“ Storage provisioner verification complete[0m
[0;34mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m

[0;34mRunning: 06-optimize-preview-resources.sh[0m
[0;34mOptimizing resources for preview mode...[0m
  [0;32mâœ“[0m Disabled NATS persistence (using memory-only mode)
[0;34mVerifying overlay optimizations...[0m
  [0;32mâœ“[0m Overlay optimizations verified (NATS, Kagent, KEDA)
[0;32mâœ“ Preview resource optimizations applied[0m
[0;34m  Estimated savings: ~400m CPU, ~500Mi memory[0m

[0;34mRunning: 07-disable-cilium-for-kind.sh[0m
[1;33mNOTE: This script is now deprecated.[0m
[0;34mCilium exclusion is now handled by Kustomize overlays:[0m
[0;34m  - bootstrap/argocd/overlays/preview/kustomization.yaml excludes cilium.yaml[0m
[0;34m  - bootstrap/argocd/overlays/production includes Cilium in overlays/production/cilium/[0m
[0;32mâœ“ No action needed - overlay structure handles Cilium exclusion[0m
[0;34m  Kind clusters use kindnet CNI instead[0m

[0;32mâœ“ All preview patches applied successfully[0m
[0;34mVerifying patches in Kind container...[0m
[0;34mNATS file in container:[0m
26:                storageClassName: local-path
[0;34mPreview overlay kustomization:[0m
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- ../../base

# URL patching is handled by 01-patch-urls.sh script (applied before ArgoCD sync)

patches:
# 1. Specific Patch: Exclude Cilium from Foundation Config
# This prevents ArgoCD from deploying platform/01-foundation/cilium.yaml
- target:
    kind: Application
    name: foundation-config
  patch: |-
    apiVersion: argoproj.io/v1alpha1
    kind: Application
    metadata:
      name: foundation-config
    spec:
      source:
        directory:
          exclude: 'cilium.yaml'

# 2. Remove Control Plane Tolerations (Kind clusters don't have control-plane taints)
- target:
    kind: Application
    name: external-secrets
  patch: |-
    apiVersion: argoproj.io/v1alpha1
    kind: Application
    metadata:
      name: external-secrets
    spec:
      source:
        helm:
          values: |
            installCRDs: true
            webhook:
              create: true

- target:
    kind: Application
    name: crossplane-operator
  patch: |-
    apiVersion: argoproj.io/v1alpha1
    kind: Application
    metadata:
      name: crossplane-operator
    spec:
      source:
        helm:
          values: |
            # Allow Crossplane to run without control plane tolerations
            tolerations: []
            args:
              - --enable-composition-revisions

- target:
    kind: Application
    name: keda
  patch: |-
    apiVersion: argoproj.io/v1alpha1
    kind: Application
    metadata:
      name: keda
    spec:
      source:
        helm:
          values: |
            operator:
              logLevel: info
            # Remove control plane tolerations for Kind
            tolerations: []

# 3. Optimize Resources for Preview Mode
- target:
    kind: Application
    name: nats
  patch: |-
    apiVersion: argoproj.io/v1alpha1
    kind: Application
    metadata:
      name: nats
    spec:
      source:
        helm:
          values: |
            container:
              resources:
                limits:
                  cpu: 250m
                  memory: 512Mi
                requests:
                  cpu: 50m
                  memory: 128Mi
            config:
              jetstream:
                fileStore:
                  enabled: false
                memoryStore:
                  enabled: true

- target:
    kind: Application
    name: kagent
  patch: |-
    apiVersion: argoproj.io/v1alpha1
    kind: Application
    metadata:
      name: kagent
    spec:
      source:
        helm:
          values: |
            # Schedule kagent agents on worker nodes with intelligence workloads
            agents:
              nodeSelector: {}
              resources:
                requests:
                  cpu: 50m
                  memory: 128Mi
                limits:
                  cpu: 250m
                  memory: 512Mi
            # Keep controller on control plane (lightweight)
            controller:
              nodeSelector: {}
              resources:
                requests:
                  cpu: 25m
                  memory: 64Mi
                limits:
                  cpu: 100m
                  memory: 256Mi
            # Disable kmcp controller - platform uses RemoteMCPServer (v1alpha2) instead of MCPServer (v1alpha1)
            kmcp:
              enabled: false[0;34mCilium status in container:[0m
ls: cannot access '/repo/platform/01-foundation/cilium.yaml*': No such file or directory
Cilium files not found
[1;33m[8/14] Installing ArgoCD...[0m
[0;32m[INFO][0m â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0;32m[INFO][0m ArgoCD Bootstrap Script
[0;32m[INFO][0m â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0;34m==>[0m Checking prerequisites...
[0;32m[INFO][0m âœ“ kubectl configured and cluster accessible
[0;32m[INFO][0m Cluster: kind-zerotouch-preview
[0;32m[INFO][0m Nodes: 1
[0;32m[INFO][0m 
[0;34m==>[0m Step 1/5: Installing ArgoCD...
[1;33m[WARN][0m ArgoCD namespace already exists
[0;32m[INFO][0m Applying ArgoCD manifests for preview mode (Kind cluster, version: v3.2.0)...
customresourcedefinition.apiextensions.k8s.io/applications.argoproj.io unchanged
customresourcedefinition.apiextensions.k8s.io/applicationsets.argoproj.io unchanged
customresourcedefinition.apiextensions.k8s.io/appprojects.argoproj.io unchanged
serviceaccount/argocd-application-controller unchanged
serviceaccount/argocd-applicationset-controller unchanged
serviceaccount/argocd-dex-server unchanged
serviceaccount/argocd-notifications-controller unchanged
serviceaccount/argocd-redis unchanged
serviceaccount/argocd-repo-server unchanged
serviceaccount/argocd-server unchanged
role.rbac.authorization.k8s.io/argocd-application-controller unchanged
role.rbac.authorization.k8s.io/argocd-applicationset-controller unchanged
role.rbac.authorization.k8s.io/argocd-dex-server unchanged
role.rbac.authorization.k8s.io/argocd-notifications-controller unchanged
role.rbac.authorization.k8s.io/argocd-redis unchanged
role.rbac.authorization.k8s.io/argocd-server unchanged
clusterrole.rbac.authorization.k8s.io/argocd-application-controller unchanged
clusterrole.rbac.authorization.k8s.io/argocd-applicationset-controller unchanged
clusterrole.rbac.authorization.k8s.io/argocd-server unchanged
rolebinding.rbac.authorization.k8s.io/argocd-application-controller unchanged
rolebinding.rbac.authorization.k8s.io/argocd-applicationset-controller unchanged
rolebinding.rbac.authorization.k8s.io/argocd-dex-server unchanged
rolebinding.rbac.authorization.k8s.io/argocd-notifications-controller unchanged
rolebinding.rbac.authorization.k8s.io/argocd-redis unchanged
rolebinding.rbac.authorization.k8s.io/argocd-server unchanged
clusterrolebinding.rbac.authorization.k8s.io/argocd-application-controller unchanged
clusterrolebinding.rbac.authorization.k8s.io/argocd-applicationset-controller unchanged
clusterrolebinding.rbac.authorization.k8s.io/argocd-server unchanged
configmap/argocd-cm unchanged
configmap/argocd-cmd-params-cm unchanged
configmap/argocd-gpg-keys-cm unchanged
configmap/argocd-notifications-cm unchanged
configmap/argocd-rbac-cm unchanged
configmap/argocd-ssh-known-hosts-cm unchanged
configmap/argocd-tls-certs-cm unchanged
secret/argocd-notifications-secret unchanged
secret/argocd-secret unchanged
service/argocd-applicationset-controller unchanged
service/argocd-dex-server unchanged
service/argocd-metrics unchanged
service/argocd-notifications-controller-metrics unchanged
service/argocd-redis unchanged
service/argocd-repo-server unchanged
service/argocd-server unchanged
service/argocd-server-metrics unchanged
deployment.apps/argocd-applicationset-controller unchanged
deployment.apps/argocd-dex-server unchanged
deployment.apps/argocd-notifications-controller unchanged
deployment.apps/argocd-redis unchanged
deployment.apps/argocd-repo-server unchanged
deployment.apps/argocd-server unchanged
statefulset.apps/argocd-application-controller unchanged
networkpolicy.networking.k8s.io/argocd-application-controller-network-policy configured
networkpolicy.networking.k8s.io/argocd-applicationset-controller-network-policy unchanged
networkpolicy.networking.k8s.io/argocd-dex-server-network-policy unchanged
networkpolicy.networking.k8s.io/argocd-notifications-controller-network-policy unchanged
networkpolicy.networking.k8s.io/argocd-redis-network-policy unchanged
networkpolicy.networking.k8s.io/argocd-repo-server-network-policy configured
networkpolicy.networking.k8s.io/argocd-server-network-policy unchanged
[0;32m[INFO][0m âœ“ ArgoCD manifests applied successfully
[0;32m[INFO][0m 
[0;34m==>[0m Step 2/5: Waiting for ArgoCD to be ready...
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Waiting for ArgoCD Pods to be Ready                       â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mâ³ Waiting for ArgoCD pods to be ready (timeout: 300s)...[0m
[0;34mNamespace: argocd[0m

[0;34m=== Checking ArgoCD pods (0s / 300s) ===[0m
[0;34mArgoCD pods: 7/7 ready[0m

[0;32mâœ“ All ArgoCD pods are ready![0m

[0;34mPod Status:[0m
NAME                                                READY   STATUS    RESTARTS      AGE   IP            NODE                              NOMINATED NODE   READINESS GATES
argocd-application-controller-0                     1/1     Running   0             11h   10.244.0.2    zerotouch-preview-control-plane   <none>           <none>
argocd-applicationset-controller-5468f5bc49-9x7hg   1/1     Running   0             11h   10.244.0.3    zerotouch-preview-control-plane   <none>           <none>
argocd-dex-server-5d4d47bcc4-hwpcc                  1/1     Running   1 (11h ago)   11h   10.244.0.4    zerotouch-preview-control-plane   <none>           <none>
argocd-notifications-controller-ddc8fdf8-jq97l      1/1     Running   0             11h   10.244.0.10   zerotouch-preview-control-plane   <none>           <none>
argocd-redis-66bbcf856f-xhr2w                       1/1     Running   0             11h   10.244.0.11   zerotouch-preview-control-plane   <none>           <none>
argocd-repo-server-67fbd8568-zqhns                  1/1     Running   0             11h   10.244.0.8    zerotouch-preview-control-plane   <none>           <none>
argocd-server-644f7bcf6f-sxsxh                      1/1     Running   0             11h   10.244.0.7    zerotouch-preview-control-plane   <none>           <none>

[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Waiting for ArgoCD Repo Server to be Responsive           â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mâ³ Waiting for ArgoCD repo server to be responsive (timeout: 120s)...[0m
[0;34mNamespace: argocd[0m

[0;34m=== Checking repo server connectivity (0s / 120s) ===[0m
[0;34mTesting repo server connectivity on port 8081...[0m
[0;32mâœ“ Repo server is responsive on port 8081[0m
[0;34mTesting repo server health endpoint on port 8084...[0m
[0;32mâœ“ Repo server health endpoint is responsive[0m
[0;34mValidating ArgoCD functionality...[0m
[0;32mâœ“ ArgoCD API is functional[0m

[0;32mâœ“ ArgoCD repo server is ready and responsive![0m

[0;32m[INFO][0m âœ“ ArgoCD is ready
[0;32m[INFO][0m 
[0;34m==>[0m Step 2.5/6: Granting ArgoCD cluster-admin permissions...
[0;32m[INFO][0m Applying cluster-admin RBAC patch...
clusterrolebinding.rbac.authorization.k8s.io/argocd-application-controller-cluster-admin unchanged
[0;32m[INFO][0m âœ“ ArgoCD has cluster-admin permissions (required for namespace creation)
[0;32m[INFO][0m 
[0;34m==>[0m Step 3/7: Configuring repository credentials...
[1;33m[WARN][0m Repository credentials already exist, skipping...
[0;32m[INFO][0m 
[0;34m==>[0m Step 4/7: Retrieving ArgoCD credentials...
[0;32m[INFO][0m âœ“ ArgoCD credentials retrieved

[0;32m[INFO][0m â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[0;32m[INFO][0m ArgoCD Login Credentials:
  [1;33mUsername:[0m admin
  [1;33mPassword:[0m VA48DC-hEvYWYFGd
[0;32m[INFO][0m â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[0;32m[INFO][0m 
[0;34m==>[0m Step 5/7: Deploying platform via Kustomize overlay...
[0;32m[INFO][0m Applying PREVIEW configuration (No Cilium, Local URLs)...
[0;32m[INFO][0m â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[0;32m[INFO][0m DEBUG: Verifying overlay configuration
[0;32m[INFO][0m â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[0;32m[INFO][0m Using overlay: bootstrap/argocd/overlays/preview
[0;32m[INFO][0m Testing kustomization build...
[0;32m[INFO][0m   Generated 10 Application resources
[0;32m[INFO][0m   Local file URLs: 0
0
[0;32m[INFO][0m   Cilium exclusions: 1
[0;32m[INFO][0m â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[0;32m[INFO][0m Applying root application...
application.argoproj.io/platform-bootstrap serverside-applied
[0;32m[INFO][0m âœ“ Platform definitions applied
[0;32m[INFO][0m 
[0;34m==>[0m Step 6/7: Waiting for initial sync...
[0;32m[INFO][0m Checking ArgoCD applications...
NAME                  SYNC STATUS   HEALTH STATUS
apis                  Synced        Healthy
cnpg                  Synced        Healthy
crossplane-operator   Synced        Healthy
databases             Synced        Healthy
external-secrets      Synced        Healthy
foundation-config     Synced        Healthy
intelligence          Synced        Healthy
kagent                Synced        Healthy
keda                  Synced        Healthy
nats                  Synced        Healthy
platform-bootstrap    Synced        Healthy
[0;32m[INFO][0m 
[0;32m[INFO][0m âœ“ GitOps deployment initiated!

\033[0;32mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m
\033[0;32mâœ“ ArgoCD Installation and Application Creation Completed!\033[0m
\033[0;32mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m

\033[1;33mWhat's Happening Now:\033[0m
- ArgoCD applications have been created but are still syncing
- Applications may show "Unknown" status initially - this is normal
- Foundation layer (Cilium, Crossplane, KEDA, Kagent) will deploy first
- Intelligence layer (Qdrant, docs-mcp, Librarian Agent) will deploy next
- Observability and APIs layers are DISABLED (as configured)

\033[1;33mâš ï¸  Note: Applications are NOT yet synced - use the monitoring commands below\033[0m

\033[1;33mMonitor Deployment:\033[0m

1. \033[0;34mWatch ArgoCD applications:\033[0m
   kubectl get applications -n argocd -w

2. \033[0;34mAccess ArgoCD UI:\033[0m
   kubectl port-forward svc/argocd-server -n argocd 8080:443
   
   Then open: https://localhost:8080
   Username: admin
   Password: VA48DC-hEvYWYFGd

3. \033[0;34mCheck specific layers:\033[0m
   # Foundation layer
   kubectl get pods -n kube-system
   kubectl get pods -n crossplane-system
   kubectl get pods -n kagent
   
   # Intelligence layer
   kubectl get pods -n intelligence

4. \033[0;34mView ArgoCD sync status:\033[0m
   kubectl get applications -n argocd
   
   # Expected applications:
   # - platform-root (root app-of-apps)
   # - foundation
   # - intelligence

\033[1;33mTroubleshooting:\033[0m
- If applications show "OutOfSync", they may be syncing
- If applications show "Degraded", check pod status
- View application details: kubectl describe application <name> -n argocd
- View ArgoCD logs: kubectl logs -n argocd -l app.kubernetes.io/name=argocd-server

\033[1;33mNext Steps:\033[0m
1. Wait 5-10 minutes for all components to sync and become healthy
2. Verify foundation layer is running
3. Verify intelligence layer components are deployed
4. Create required secrets (GitHub token, OpenAI key) for intelligence layer

\033[0;32mDocumentation:\033[0m
- ArgoCD: https://argo-cd.readthedocs.io/
- Platform walkthrough: See walkthrough.md artifact

[1;33m[9/14] Waiting for platform-bootstrap...[0m
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Waiting for Platform Bootstrap                            â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mâ³ Waiting for platform-bootstrap to sync (timeout: 5 minutes)...[0m
[0;34mplatform-bootstrap found: Synced / Healthy[0m
[0;32mâœ“ platform-bootstrap synced successfully[0m

[1;33m[10/14] Verifying ESO...[0m
[0;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—[0m
[0;34mâ•‘   Verifying External Secrets Operator                       â•‘[0m
[0;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•[0m

[0;34mStep 1: Checking ESO credentials...[0m
[0;32mâœ“ ESO credentials found[0m

[0;34mStep 2: Waiting for ClusterSecretStore to be valid...[0m
[0;32mâœ“ ClusterSecretStore 'aws-parameter-store' is valid[0m

[0;34mStep 3: Force re-syncing all ExternalSecrets...[0m
[0;34m   Found 4 ExternalSecrets[0m
externalsecret.external-secrets.io/deepagents-runtime-llm-keys annotated
   [0;32mâœ“[0m Triggered: intelligence-deepagents/deepagents-runtime-llm-keys
externalsecret.external-secrets.io/kagent-openai-es annotated
   [0;32mâœ“[0m Triggered: intelligence-platform/kagent-openai-es
externalsecret.external-secrets.io/kagent-openai-es annotated
   [0;32mâœ“[0m Triggered: kagent/kagent-openai-es

[0;34mStep 4: Waiting for ExternalSecrets to sync (max 100s)...[0m
   [10s] Total: 4 | [0;32mSynced: 3[0m | [0;31mFailed: 0[0m | Pending: 1
   [20s] Total: 4 | [0;32mSynced: 3[0m | [0;31mFailed: 0[0m | Pending: 1
   [30s] Total: 4 | [0;32mSynced: 3[0m | [0;31mFailed: 0[0m | Pending: 1
   [40s] Total: 4 | [0;32mSynced: 3[0m | [0;31mFailed: 0[0m | Pending: 1
   [50s] Total: 4 | [0;32mSynced: 3[0m | [0;31mFailed: 0[0m | Pending: 1
[0;34m[INFO][0m Cleaning up...
[0;34m[INFO][0m Removing fresh platform directory...
[0;34m[INFO][0m Log file saved at: /Users/arun_subramanian/Projects/biz-matters/deepagents-runtime/scripts/local/ci/logs/nats_events_20251220_131243.log
[0;34m[INFO][0m Cluster kept running for debugging - use 'kind delete cluster zerotouch-preview' to clean up manually
[0;34m[INFO][0m Cleaning up...
[0;34m[INFO][0m Log file saved at: /Users/arun_subramanian/Projects/biz-matters/deepagents-runtime/scripts/local/ci/logs/nats_events_20251220_131243.log
[0;34m[INFO][0m Cluster kept running for debugging - use 'kind delete cluster zerotouch-preview' to clean up manually
